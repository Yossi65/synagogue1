
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>code_2025-11-22T21-47-14-270Z.html</title>
                </head>
                <body>
                    <!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××—×•×œ×œ ××•×“×¢×•×ª ×©×‘×ª</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; color: #333; padding: 20px; max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; color: #2c3e50; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .input-group { margin-bottom: 15px; display: flex; align-items: center; flex-wrap: wrap; }
        .input-group label { flex: 1; min-width: 200px; font-weight: 600; }
        .input-group input, .input-group select, .input-group textarea { flex: 1; padding: 8px; border: 1px solid #ced4da; border-radius: 4px; font-size: 16px; }
        .section-title { background-color: #e9ecef; padding: 10px; margin-top: 20px; margin-bottom: 15px; border-radius: 5px; font-weight: bold; color: #495057; border-right: 5px solid #007bff; }
        .buttons-container { display: flex; gap: 10px; margin-top: 20px; }
        button.action-btn { flex: 1; padding: 15px; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background 0.3s; color: white; }
        .btn-whatsapp { background-color: #28a745; }
        .btn-image { background-color: #5c3a21; }
        .btn-download { background-color: #007bff; width: 100%; margin-top: 10px; } /* ×›×¤×ª×•×¨ ×”×•×¨×“×” ×—×“×© */
        .template-actions { background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 10px; justify-content: center; }
        .btn-save-template { background-color: #17a2b8; color: white; padding: 10px; border: none; border-radius: 5px; cursor: pointer; flex: 1; }
        .btn-clear { background-color: #6c757d; color: white; padding: 10px; border: none; border-radius: 5px; cursor: pointer; flex: 0.3; }
        #generated-image-container { margin-top: 30px; text-align: center; display: none; }
        #generated-image-container img { max-width: 100%; height: auto; border-radius: 8px; border: 3px solid #5c3a21; }
        #hiddenCanvas { display: none; }
        #imageStatus { font-weight: bold; margin-bottom: 10px; color: #0056b3; }
        #whatsapp-output-area { display: none; margin-top: 20px; padding: 15px; background: #e8f5e9; border-radius: 8px; }
        textarea { width: 100%; height: 150px; }
        .copy-btn { background-color: #007bff; color: white; padding: 10px; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; width: 100%; }
        .slider-container { background-color: #fff3cd; padding: 10px; border-radius: 8px; text-align: center; margin-bottom: 20px;}
        input[type=range] { width: 80%; }
    </style>
</head>
<body>

<div class="container">
    <h1>××—×•×œ×œ ××•×“×¢×•×ª ×©×‘×ª</h1>
    
    <div style="text-align:center; margin-bottom: 20px; padding: 10px; background: #e3f2fd; border-radius: 8px;">
        <p id="imageStatus">×˜×•×¢×Ÿ ×ª××•× ×ª ×¨×§×¢ ××”×¢× ×Ÿ...</p>
        <input type="file" id="bgImageInput" accept="image/png, image/jpeg" style="display:none; margin-top:5px;"> 
        <button onclick="document.getElementById('bgImageInput').style.display='inline-block'" style="background:none; border:none; text-decoration:underline; color:#666; font-size:12px; cursor:pointer;">(×”×¢×œ××” ×™×“× ×™×ª ×‘××§×¨×” ×©×œ ×ª×§×œ×”)</button>
    </div>

    <div class="slider-container">
        <label>×’×•×“×œ ×˜×§×¡×˜ ×‘×ª××•× ×”:</label><br>
        <input type="range" id="fontSizeSlider" min="20" max="50" value="32">
    </div>

    <div class="template-actions">
        <button class="btn-save-template" onclick="saveFormData()">ğŸ’¾ ×©××•×¨ × ×ª×•× ×™× ×§×‘×•×¢×™×</button>
        <button class="btn-clear" onclick="clearFormData()">ğŸ—‘ï¸ × ×§×”</button>
    </div>

    <div class="input-group">
        <label>×‘×—×¨ ×¤×¨×©×”:</label>
        <select id="parasha">
            <option value="" selected>×œ×œ× / ×™×“× ×™</option>
            <optgroup label="×‘×¨××©×™×ª"><option>×‘×¨××©×™×ª</option><option>× ×—</option><option>×œ×š ×œ×š</option><option>×•×™×¨×</option><option>×—×™×™ ×©×¨×”</option><option>×ª×•×œ×“×•×ª</option><option>×•×™×¦×</option><option>×•×™×©×œ×—</option><option>×•×™×©×‘</option><option>××§×¥</option><option>×•×™×’×©</option><option>×•×™×—×™</option></optgroup>
            <optgroup label="×©××•×ª"><option>×©××•×ª</option><option>×•××¨×</option><option>×‘×</option><option>×‘×©×œ×—</option><option>×™×ª×¨×•</option><option>××©×¤×˜×™×</option><option>×ª×¨×•××”</option><option>×ª×¦×•×”</option><option>×›×™ ×ª×©×</option><option>×•×™×§×”×œ</option><option>×¤×§×•×“×™</option></optgroup>
            <optgroup label="×•×™×§×¨×"><option>×•×™×§×¨×</option><option>×¦×•</option><option>×©××™× ×™</option><option>×ª×–×¨×™×¢</option><option>××¦×•×¨×¢</option><option>××—×¨×™ ××•×ª</option><option>×§×“×•×©×™×</option><option>×××•×¨</option><option>×‘×”×¨</option><option>×‘×—×•×§×•×ª×™</option></optgroup>
            <optgroup label="×‘××“×‘×¨"><option>×‘××“×‘×¨</option><option>× ×©×</option><option>×‘×”×¢×œ×•×ª×š</option><option>×©×œ×—</option><option>×§×•×¨×—</option><option>×—×•×§×ª</option><option>×‘×œ×§</option><option>×¤× ×—×¡</option><option>××˜×•×ª</option><option>××¡×¢×™</option></optgroup>
            <optgroup label="×“×‘×¨×™×"><option>×“×‘×¨×™×</option><option>×•××ª×—× ×Ÿ</option><option>×¢×§×‘</option><option>×¨××”</option><option>×©×•×¤×˜×™×</option><option>×›×™ ×ª×¦×</option><option>×›×™ ×ª×‘×•×</option><option>× ×¦×‘×™×</option><option>×•×™×œ×š</option><option>×”××–×™× ×•</option><option>×•×–××ª ×”×‘×¨×›×”</option></optgroup>
            <optgroup label="×—×’×™×"><option>×¨××© ×”×©× ×”</option><option>×™×•× ×›×™×¤×•×¨</option><option>×¡×•×›×•×ª</option><option>×©××—×ª ×ª×•×¨×”</option><option>×—× ×•×›×”</option><option>×¤×•×¨×™×</option><option>×¤×¡×—</option><option>×©×‘×•×¢×•×ª</option><option>×™×•× ×”×¢×¦×××•×ª</option></optgroup>
        </select>
    </div>
    <div class="input-group"><label>××• ×”×§×œ×“ ×™×“× ×™×ª:</label><input type="text" id="custom_parasha"></div>

    <div class="section-title">×–×× ×™×</div>
    <div class="input-group"><label>×›× ×™×¡×ª ×”×©×‘×ª:</label><input type="tel" id="time_knisa" class="time-input"></div>
    <div class="input-group"><label>×¦××ª ×”×©×‘×ª:</label><input type="tel" id="time_tzeit" class="time-input"></div>
    
    <div class="section-title">×¢×¨×‘ ×©×‘×ª</div>
    <div class="input-group"><label>×× ×—×” ×¢×¨×‘ ×©×‘×ª:</label><input type="tel" id="time_mincha_eve" class="time-input"></div>
    <div class="input-group"><label>×§×‘×œ×ª ×©×‘×ª ×•×¢×¨×‘×™×ª:</label><input type="tel" id="time_kabalat" class="time-input"></div>
    <div class="input-group"><label>×”×•×“×¢×” ××™×•×—×“×ª:</label><textarea id="special_eve" style="height:50px"></textarea></div>

    <div class="section-title">×‘×•×§×¨ ×©×‘×ª</div>
    <div class="input-group"><label>×©×—×¨×™×ª (×§×•×¨×‘× ×•×ª):</label><input type="tel" id="time_shacharit" class="time-input"></div>
    <div class="input-group"><label>×”×•×“×•:</label><input type="tel" id="time_hodu" class="time-input"></div>
    <div class="input-group"><label>×ª×¤×™×œ×ª ×™×œ×“×™×:</label><input type="text" id="text_kids" value="×ª×¤×™×œ×ª ×™×œ×“×™× ×œ××—×¨ ××•×¡×£."></div>
    <div class="input-group"><label>×”×•×“×¢×” ××™×•×—×“×ª:</label><textarea id="special_morning" style="height:50px"></textarea></div>

    <div class="section-title">×¦×”×¨×™×™×</div>
    <div class="input-group"><label>×ª×”×™×œ×™× ×œ×™×œ×“×™×:</label><input type="tel" id="time_psalms" class="time-input"></div>
    <div class="input-group"><label>×©×™×¢×•×¨ ×œ×¤× ×™ ×× ×—×”:</label><input type="tel" id="time_class_mincha" class="time-input"></div>
    <div class="input-group"><label>×× ×—×” ×©×œ ×©×‘×ª:</label><input type="tel" id="time_mincha_day" class="time-input"></div>
    <div class="input-group"><label>×©×™×¢×•×¨ ×œ× ×©×™×:</label><input type="tel" id="time_women" class="time-input"></div>
    <div class="input-group"><label>×©×™×¢×•×¨ ×œ×¤× ×™ ×¢×¨×‘×™×ª:</label><input type="tel" id="time_class_arvit" class="time-input"></div>
    <div class="input-group"><label>×¢×¨×‘×™×ª ××•×¦"×©:</label><input type="tel" id="time_arvit_motzash" class="time-input"></div>

    <div class="section-title">×™××•×ª ×”×©×‘×•×¢</div>
    <div class="input-group"><label>×©×—×¨×™×ª (×©×™×©×™):</label><input type="tel" id="time_week_shacharit" value="08:15" class="time-input"></div>
    <div class="input-group"><label>×¢×¨×‘×™×ª (×—×•×œ):</label><input type="tel" id="time_week_arvit" value="20:15" class="time-input"></div>

    <div class="buttons-container">
        <button class="action-btn btn-whatsapp" onclick="generateWhatsappMessage()">×”×›×Ÿ ×˜×§×¡×˜ ×œ×•×•××˜×¡××¤</button>
        <button class="action-btn btn-image" onclick="generateImage()">×¦×•×¨ ×ª××•× ×” ×œ×”×•×¨×“×”</button>
    </div>

    <div id="whatsapp-output-area">
        <h3>×”×•×“×¢×” ××•×›× ×”:</h3>
        <textarea id="whatsapp-result"></textarea>
        <button class="copy-btn" onclick="copyToClipboard()">ğŸ“‹ ×”×¢×ª×§ ×œ×œ×•×—</button>
    </div>

    <div id="generated-image-container">
        <h3>×”×ª××•× ×” ×”××•×›× ×”:</h3>
        <img id="finalImage">
        <button class="action-btn btn-download" onclick="downloadImage()">ğŸ“¥ ×”×•×¨×“ ×ª××•× ×” ×œ××›×©×™×¨</button>
    </div>
</div>

<canvas id="hiddenCanvas"></canvas>

<script>
    let loadedBgImage = null;
    const canvas = document.getElementById('hiddenCanvas');
    const ctx = canvas.getContext('2d');
    const imageStatus = document.getElementById('imageStatus');

    window.onload = function() {
        const img = new Image();
        img.src = 'https://raw.githubusercontent.com/Yossi65/synagogue/main/background.png';
        img.crossOrigin = "Anonymous"; 
        
        img.onload = function() {
            loadedBgImage = img;
            canvas.width = img.width;
            canvas.height = img.height;
            imageStatus.innerText = "âœ… ×ª××•× ×ª ×¨×§×¢ × ×˜×¢× ×” ×‘×”×¦×œ×—×” ××”×¢× ×Ÿ!";
            imageStatus.style.color = "green";
            document.getElementById('bgImageInput').style.display = 'none';
        };

        img.onerror = function() {
            imageStatus.innerText = "âš ï¸ ×©×’×™××” ×‘×˜×¢×™× ×”. × ×¡×” ×œ×¨×¢× ×Ÿ ××ª ×”×“×£.";
            imageStatus.style.color = "red";
        };

        const savedData = localStorage.getItem('shabbatFormData');
        if (savedData) {
            const data = JSON.parse(savedData);
            for (const key in data) {
                const el = document.getElementById(key);
                if (el) el.value = data[key];
            }
        }
    };

    document.getElementById('bgImageInput').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(event) {
            const img = new Image();
            img.onload = function() {
                loadedBgImage = img;
                canvas.width = img.width;
                canvas.height = img.height;
                imageStatus.innerText = "âœ… ×ª××•× ×” ×”×•×¢×œ×ª×” ×™×“× ×™×ª";
                imageStatus.style.color = "green";
            }
            img.src = event.target.result;
        }
        reader.readAsDataURL(file);
    });

    document.querySelectorAll('.time-input').forEach(input => {
        input.addEventListener('blur', function() {
            let val = this.value.replace(/[^0-9]/g, '');
            if (val.length === 0) return;
            if (val.length === 1) val = "0" + val + ":00";
            else if (val.length === 2) val = val + ":00";
            else if (val.length === 3) val = "0" + val.substring(0,1) + ":" + val.substring(1);
            else if (val.length >= 4) val = val.substring(0, 2) + ":" + val.substring(2, 4);
            this.value = val;
        });
    });

    function saveFormData() {
        const inputs = document.querySelectorAll('input[type="text"], input[type="tel"], textarea, select');
        const data = {};
        inputs.forEach(input => {
            if(input.id !== 'fontSizeSlider') data[input.id] = input.value;
        });
        localStorage.setItem('shabbatFormData', JSON.stringify(data));
        alert('×”× ×ª×•× ×™× × ×©××¨×•!');
    }

    function clearFormData() {
        if(confirm("×œ× ×§×•×ª ×”×›×œ?")) {
            document.querySelectorAll('input[type="text"], input[type="tel"], textarea').forEach(i => i.value = '');
            document.getElementById('parasha').value = '';
        }
    }

    function getFormData() {
        const listParasha = document.getElementById('parasha').value;
        const customParasha = document.getElementById('custom_parasha').value;
        let finalParashaName = customParasha.trim() !== "" ? customParasha : listParasha;
        
        const data = { parasha: finalParashaName };
        const ids = ['time_knisa', 'time_tzeit', 'time_mincha_eve', 'time_kabalat', 'special_eve', 
                     'time_shacharit', 'time_hodu', 'text_kids', 'special_morning', 'time_psalms', 
                     'time_class_mincha', 'time_mincha_day', 'time_women', 'time_class_arvit', 
                     'time_arvit_motzash', 'time_week_shacharit', 'time_week_arvit'];
        ids.forEach(id => data[id] = document.getElementById(id).value);
        return data;
    }

    function generateWhatsappMessage() {
        const data = getFormData();
        const bold = (text) => text ? `*${text}*` : '';
        let msg = `*×œ×”×œ×Ÿ ×–×× ×™ ×”×ª×¤×™×œ×•×ª ×œ×©×‘×ª ×¤×¨×©×ª '${data.parasha}':*\n\n`;
        
        if(data.time_knisa) msg += `×›× ×™×¡×ª ×”×©×‘×ª - ${bold(data.time_knisa)}\n`;
        if(data.time_tzeit) msg += `×¦××ª ×”×©×‘×ª - ${bold(data.time_tzeit)}\n`;
        if(data.time_mincha_eve) msg += `×× ×—×” ×¢×¨×‘ ×©×‘×ª (××©×¨×™) - ${bold(data.time_mincha_eve)}\n`;
        if(data.time_kabalat) msg += `×§×‘×œ×ª ×©×‘×ª ×•×¢×¨×‘×™×ª - ${bold(data.time_kabalat)}\n`;
        if(data.special_eve) msg += `${bold(data.special_eve)}\n`;
        
        msg += `\n`;
        if(data.time_shacharit) msg += `×©×—×¨×™×ª (×§×•×¨×‘× ×•×ª) - ${bold(data.time_shacharit)}\n`;
        if(data.time_hodu) msg += `×”×•×“×• - ${bold(data.time_hodu)}\n`;
        if(data.text_kids) msg += `${data.text_kids}\n`;
        if(data.special_morning) msg += `${bold(data.special_morning)}\n`;
        
        msg += `\n`;
        if(data.time_psalms) msg += `×ª×”×™×œ×™× ×œ×™×œ×“×™× - ${bold(data.time_psalms)}\n`;
        if(data.time_class_mincha) msg += `×©×™×¢×•×¨ ×œ×¤× ×™ ×× ×—×” - ${bold(data.time_class_mincha)}\n`;
        if(data.time_mincha_day) msg += `×× ×—×” ×©×œ ×©×‘×ª - ${bold(data.time_mincha_day)}\n`;
        if(data.time_women) msg += `×©×™×¢×•×¨ ×œ× ×©×™× - ${bold(data.time_women)}\n`;
        if(data.time_class_arvit) msg += `×©×™×¢×•×¨ ×œ×¤× ×™ ×¢×¨×‘×™×ª - ${bold(data.time_class_arvit)}\n`;
        if(data.time_arvit_motzash) msg += `×¢×¨×‘×™×ª ××•×¦"×© - ${bold(data.time_arvit_motzash)}\n`;

        msg += `\n*×©×‘×ª ×©×œ×•×*\n`;
        msg += `×ª×¤×™×œ×•×ª ×‘×©××¨ ×™××•×ª ×”×©×‘×•×¢: ×©×—×¨×™×ª (×©×™×©×™) - ${bold(data.time_week_shacharit)}, ×¢×¨×‘×™×ª - ${bold(data.time_week_arvit)}`;

        document.getElementById('whatsapp-result').value = msg;
        document.getElementById('whatsapp-output-area').style.display = 'block';
        document.getElementById('generated-image-container').style.display = 'none';
        document.getElementById('whatsapp-output-area').scrollIntoView({behavior: "smooth"});
    }

    function copyToClipboard() {
        const txt = document.getElementById("whatsapp-result");
        if (navigator.clipboard) {
            navigator.clipboard.writeText(txt.value).then(() => alert("×”×•×¢×ª×§!")).catch(() => fallbackCopy(txt));
        } else { fallbackCopy(txt); }
    }
    function fallbackCopy(txt) { txt.select(); document.execCommand('copy'); alert("×”×•×¢×ª×§!"); }

    function generateImage() {
        if (!loadedBgImage) { alert("××™×Ÿ ×ª××•× ×ª ×¨×§×¢!"); return; }
        const data = getFormData();
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(loadedBgImage, 0, 0);
        
        ctx.textAlign = 'center'; ctx.fillStyle = '#3d2b1f';
        const centerX = canvas.width / 2;
        const fontMultiplier = document.getElementById('fontSizeSlider').value / 1000;
        const fontSize = canvas.height * fontMultiplier;
        const lineHeight = fontSize * 1.4;

        let currentY = canvas.height * 0.23;
        ctx.font = 'bold ' + (fontSize * 1.1) + 'px "David", "Frank Ruhl Libre", serif';
        ctx.fillText("×œ×”×œ×Ÿ ×–×× ×™ ×”×ª×¤×™×œ×•×ª", centerX, currentY);
        currentY += lineHeight;
        ctx.fillText(`×œ×©×‘×ª ×¤×¨×©×ª '${data.parasha}':`, centerX, currentY);

        currentY += lineHeight * 1.2;
        ctx.font = 'bold ' + fontSize + 'px "David", "Frank Ruhl Libre", serif';

        function draw(txt) {
            if (currentY > canvas.height * 0.78) return;
            if (txt && txt.trim()) { ctx.fillText(txt, centerX, currentY); currentY += lineHeight; }
        }

        draw(data.time_knisa ? `×›× ×™×¡×ª ×”×©×‘×ª - ${data.time_knisa}` : '');
        draw(data.time_tzeit ? `×¦××ª ×”×©×‘×ª - ${data.time_tzeit}` : '');
        draw(data.time_mincha_eve ? `×× ×—×” ×¢×¨×‘ ×©×‘×ª (××©×¨×™) - ${data.time_mincha_eve}` : '');
        draw(data.time_kabalat ? `×§×‘×œ×ª ×©×‘×ª ×•×¢×¨×‘×™×ª - ${data.time_kabalat}` : '');
        draw(data.special_eve);
        if (currentY < canvas.height * 0.7) currentY += lineHeight * 0.5;
        
        draw(data.time_shacharit ? `×©×—×¨×™×ª (×§×•×¨×‘× ×•×ª) - ${data.time_shacharit}` : '');
        draw(data.time_hodu ? `×”×•×“×• - ${data.time_hodu}` : '');
        draw(data.text_kids);
        draw(data.special_morning);
        if (currentY < canvas.height * 0.7) currentY += lineHeight * 0.5;

        draw(data.time_psalms ? `×ª×”×™×œ×™× ×œ×™×œ×“×™× - ${data.time_psalms}` : '');
        draw(data.time_class_mincha ? `×©×™×¢×•×¨ ×œ×¤× ×™ ×× ×—×” - ${data.time_class_mincha}` : '');
        draw(data.time_mincha_day ? `×× ×—×” ×©×œ ×©×‘×ª - ${data.time_mincha_day}` : '');
        draw(data.time_women ? `×©×™×¢×•×¨ ×œ× ×©×™× - ${data.time_women}` : '');
        draw(data.time_class_arvit ? `×©×™×¢×•×¨ ×œ×¤× ×™ ×¢×¨×‘×™×ª - ${data.time_class_arvit}` : '');
        draw(data.time_arvit_motzash ? `×¢×¨×‘×™×ª ××•×¦"×© - ${data.time_arvit_motzash}` : '');

        ctx.font = 'bold ' + (fontSize * 1.2) + 'px serif';
        ctx.fillText("×©×‘×ª ×©×œ×•×", centerX, canvas.height * 0.83);

        ctx.font = 'bold ' + (fontSize * 0.65) + 'px serif';
        ctx.fillText("×ª×¤×™×œ×•×ª ×‘×©××¨ ×™××•×ª ×”×©×‘×•×¢:", centerX, canvas.height * 0.905);
        
        let weekMsg = "";
        if(data.time_week_shacharit) weekMsg += `×©×—×¨×™×ª (×©×™×©×™) - ${data.time_week_shacharit}`;
        if(data.time_week_shacharit && data.time_week_arvit) weekMsg += `, `;
        if(data.time_week_arvit) weekMsg += `×¢×¨×‘×™×ª - ${data.time_week_arvit}`;
        ctx.fillText(weekMsg, centerX, canvas.height * 0.94);

        document.getElementById('finalImage').src = canvas.toDataURL('image/jpeg', 0.9);
        document.getElementById('generated-image-container').style.display = 'block';
        document.getElementById('whatsapp-output-area').style.display = 'none';
        document.getElementById('generated-image-container').scrollIntoView({behavior: "smooth"});
    }

    // --- ×¤×•× ×§×¦×™×” ×—×“×©×” ×œ×”×•×¨×“×ª ×”×ª××•× ×” ---
    function downloadImage() {
        const link = document.createElement('a');
        const data = getFormData();
        const fileName = `×–×× ×™_×©×‘×ª_×¤×¨×©×ª_${data.parasha.replace(/\s+/g, '_')}.jpg`;
        
        link.download = fileName;
        link.href = document.getElementById('finalImage').src;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
</script>
</body>
</html>
                </body>
                </html>
            